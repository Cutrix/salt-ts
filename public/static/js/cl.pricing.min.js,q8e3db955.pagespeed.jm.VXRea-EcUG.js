var Cl=window.Cl||{};(function($){Cl.Pricing={state:0,initialize:function(){var isTouch=this.isTouchSupported();this.findBlocks().bindEvents(isTouch).initPopovers().position()},findBlocks:function(){this.container=$(".js-pricing");this.wrapper=$(".js-pricing-wrapper");this.items=$(".js-pricing-item");this.maxStateRight=Math.floor((this.items.length-1)/2);this.maxStateLeft=Math.floor(this.items.length/2);this.arrows=$(".js-pricing-arrows");this.infoTrigger=$(".js-info-trigger");return this},bindEvents:function(isTouch){if(isTouch){(new Hammer(this.container[0])).on("swipeleft swiperight",$.proxy(this._onSwipe,this));this.infoTrigger.on("click",this._onInfoTrigger);this.items.on("click",this._onItemTouch)}else this.infoTrigger.on("mouseenter mouseleave",this._onInfoTrigger);this.arrows.find("a").on("click",this._onArrowClick);$(window).on("resize",this.debounce($.proxy(this._onWindowResize,this),200));return this},initPopovers:function(){this.infoTrigger.each(function(){$(this).popover({placement:function(context,source){if(Cl.Pricing.getSizes().viewport<Cl.settings.responsiveMd)return"left";else return $(source).data("popover-direction")||"right"},trigger:"manual",html:true,content:function(){var item=$(this).data("popover-source");return $("#"+item).html()}})});return this},_onSwipe:function(e){this.switchState(e.type==="swipeleft"?1:-1)},_onArrowClick:function(e){e.preventDefault();var increment=$(this).hasClass("pricing-arrows-next")?1:-1;Cl.Pricing.switchState(increment)},_onInfoTrigger:function(e){e.preventDefault();var trigger=$(this);var eventType=e.type;var action={click:"toggle",mouseenter:"show",mouseleave:"hide"};if(eventType==="mouseleave"){setTimeout(function(){var hoveredPopover=$(".popover:hover");if(hoveredPopover.length)hoveredPopover.one("mouseleave",function(){trigger.popover("hide")});else trigger.popover("hide")},50);return false}trigger.popover(action[eventType])},_onItemTouch:function(e){if(!$(e.target).hasClass("btn"))e.preventDefault()},_onWindowResize:function(){this.infoTrigger.popover("hide");this.position()},position:function(){var sizes=this.getSizes();var centerOffset=(sizes.wrapper-sizes.viewport)/2;var offset=centerOffset+(this.state-(this.items.length<=3?1:0))*sizes.item;this.wrapper.css({left:-offset})},getSizes:function(){return{viewport:$(window).width(),wrapper:this.wrapper.width(),item:this.items.first().outerWidth()}},switchState:function(increment){if(!this.isEdge(this.state+increment)){this.state+=increment;this.position();this.displayArrows(increment)}return this},displayArrows:function(increment){var direction=increment>0?"next":"prev";var isUnscrollable=this.isEdge(this.state+increment);var arrows=this.arrows.find("a");var hiddenClass="pricing-arrow-hidden";if(isUnscrollable)$(".js-pricing-arrows-"+direction).addClass(hiddenClass);else if(arrows.hasClass(hiddenClass))arrows.removeClass(hiddenClass);return this},isEdge:function(state){if(state>=0)return this.maxStateRight<Math.abs(state);else return this.maxStateLeft<Math.abs(state)},isTouchSupported:function(){return"ontouchstart"in window||window.DocumentTouch&&document instanceof window.DocumentTouch},debounce:function(callback,delay){var timer;return function(){clearTimeout(timer);timer=setTimeout(function(){callback.apply()},delay)}}}})(jQuery);